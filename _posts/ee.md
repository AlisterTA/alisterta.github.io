---
layout: post
title: ูุนูุงุฑ MobileNetsู Xception (ุจุฎุด ุงูู)
---
ููุงูู ุง ฺฉู ุงุฎุฑุง ุชูุณุท ฺฏูฺฏู ููุชุดุฑ ุดุฏ ฺฉ ูุนูุงุฑ ุฌุฏุฏ ุงุณุช ุจู ูุงู MobileNets ฺฉู ุจุฑุง [ุณุณุชู ูุง ุชุนุจู ุดุฏู](https://en.wikipedia.org/wiki/Embedded_system) ูุซู ููุจุงู ุจููู ุณุงุฒ ุดุฏู ุงุณุช. ุฏุฑ ูุณุชู ุงุตู ุงู ูุนูุงุฑ ฺฉุงููููุดู ุจุฑ ุญุณุจ ฺฉุงูุงู ุชูฺฉฺฉ ูพุฐุฑ (depthwise separable convolution) ุจุฑุง ุณุงุฎุช ฺฉ ุดุจฺฉู ุนุตุจ ุณุจฺฉ ุงุณุชูุงุฏู ุดุฏู ุงุณุช .

ูู ููุดู ุจู ุดุจฺฉู ูุง ุนุตุจ ฺฉุงููููุดูุงู ุณุจฺฉ (lightweight) ุนูุงูู ููุฏ ุจูุฏูุ ฺูุฏ ุฑูุฒ ูพุด ุชุตูู ฺฏุฑูุชู ฺฉู ููุงูู [MobileNets](https://arxiv.org/abs/1704.04861) ุฑุง ูุทุงูุนู ฺฉูู ุงูุง ุฏุฑ ูุงูู ุฑุงู ูุฌุจูุฑ ุดุฏู ููุงูู [Xception](https://arxiv.org/abs/1610.02357) ุ ฺฉู ุชูุณุท Franรงois Chollet (ููุณูุฏู [ฺฉุชุงุจุฎุงูู ูุชู ุจุงุฒ ุดุจฺฉู ุนุตุจ ฺฉุฑุงุณ](https://en.wikipedia.org/wiki/Keras) ู ููุณุณ [Wysp](https://www.wysp.ws/) ฺฉู ฺฉ ูพูุชโูุฑู ุจุฑุง ููุฑููุฏุงู ุงุณุช) ููุชุดุฑ ุดุฏู ุงุณุชุ ุฑุง ุจุฎูุงูู . ุงู ูพุณุช ุฏุฑ ูุงูุน ุฌูุน ุจูุฏ ุงู ุฏู ููุงูู ุงุณุช. ุจุง ุดฺฉู ฺฏุฑ ุดุงุฎู ุงุฏฺฏุฑ ุนูู ุงุตุทูุงุญุงุช ุฒุงุฏ ุจู ูุฌูุฏ ุขูุฏ ฺฉู ูุนุงุฏู ูุงุฑุณ ุจุฑุง ุขููุง ูุฌูุฏ ูุฏุงุฑูุฏ (ุง ูู ุงุฒ ุขููุง ุจ ุงุทูุงุน ูุณุชู ๐ ). ุฏุฑ ุงู ูพุณุช ุณุน ฺฉุฑุฏู ุจุฑุง ูุฑ ฺฉุฏุงู ุงุฒ ุงู ุนุจุงุฑุงุช ูุนุงุฏู ูุงุฑุณ ฺฉู ุชูุตู ฺฉููุฏู ุขู ฺฉููู ูุณุช ุงุณุชูุงุฏู ฺฉูู ุ ุฏุฑ ุตูุฑุช ฺฉู ูุนุงู ุจูุชุฑ ุจุฑุง ุขููุง ุฏุฑ ุฐูู ุฏุงุฑุฏ ุง ูุจูุง ูุฌูุฏ ุฏุงุดุชู ุงุณุช ูุทูุง ุจู ูู ุงุทูุงุน ุฏูุฏ ุชุง ุงุตูุงุญ ฺฉูู. ๐๐ฝ

ุฏุฑ ูุฑ ุฏู ุงู ููุงูู ุจุฑุง ฺฉุงูุด ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ูุง ุดุจฺฉู ฺฉุงููููุดูุงู ุงุฒ ุฏู ุนููุงุช ฺฉุงููููุดู ุจู ูุงู ูุง ฺฉุงููููุดู ููุทู ุง(pointwise) ู ฺฉุงููููุดู ุจุฑ ุญุณุจ ฺฉุงูุงู(depthwise) ุงุณุชูุงุฏู ูุดูุฏ ฺฉู ุฏุฑ ุญู ฺฉุงูุด ูุงุจู ุชูุฌู ูพุงุฑุงูุชุฑ ูุง ุฏูุช ูุฒ ุฏุฑ ุญุฏ ูุทููุจ ุจุงู ููุงูุฏ. ุจู ุนุจุงุฑุช ุจุฏู ู ุจุณุชุงู ุจู ุฏูุช ู ูพุงุฑุงูุชุฑ ูุง ุจูุจูุฏ ูพุฏุง ูฺฉูุฏ!

![_config.yml]({{ site.baseurl }}/images/9/1.png)

ุณุงุฎุช ฺฉ ุดุจฺฉู ุณุจฺฉ ูุฒู(ฺฉ ุดุจฺฉู ุจุง ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ฺฉูุชุฑ) ุจุฑุง ุชููู ูุง ููุฑุงูุ ุฏุณุชฺฏุงู ูุง ฺฉู ูุฏุฑุช ูุญุงุณุจุงุช ุขููุง ูุญุฏูุฏ ุงุณุช ฺฉ ุฒููู ุจุงุฒ ุฏุฑ ูุจุญุซ ุงุฏฺฏุฑ ุนูู ุงุณุช. ุจุง ฺฉุงูุด ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ูุง ุงู ุงูฺฉุงู ูุฒ ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุดุจฺฉู ุง ุนูู ุชุฑ ุงุฌุงุฏ ฺฉูู ุฏุฑ ูุชุฌู ุฏูุช ูุฒ ูุชูุงูุฏ ุงูุฒุงุด ูพุฏุง ฺฉูุฏ .  

ูุชุฏ ูุง ุฒุงุฏ ุจุฑุง ุงุฌุงุฏ ุงู ฺูู ุดุจฺฉู ูุง ูุฌูุฏ ุฏุงุฑูุฏุ ุงูุง ูุชูุงู ุขููุง ุฑุง ุจู ุฏู ุจุฎุด ุนูุฏู ุชูุณู ฺฉุฑุฏ: 
1-	ฺฉุงูุด ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ูุง ุจุง ุงุจุฏุงุน ุณุงุฎุชุงุฑ ุฌุฏุฏ ูุงู ฺฉุงููููุดู 
ุจู ุนููุงู ูุซุงู ูุชุฏ ูุง ฺฉู ุฏุฑ ููุงูู ูุง [GoogLeNet](https://arxiv.org/abs/1409.4842)ุ[ResNet](https://arxiv.org/abs/1512.03385)ุ [SqueezeNet](https://arxiv.org/abs/1602.07360)ุ[MobileNets](https://arxiv.org/abs/1704.04861) ุ[Xception](https://arxiv.org/abs/1704.04861) ู[ShuffleNet](https://arxiv.org/pdf/1707.01083.pdf)ูุนุฑู ุดุฏูุฏ.
2-	ูุดุฑุฏู ุณุงุฒ ูพุงุฑุงูุชุฑ ูุง
ุจู ุนููุงู ูุซุงู ูุชูุงู ุจู ููุงูู ูุง ูุซู [BinaryConnect](https://arxiv.org/abs/1511.00363)ุ[Binarized Neural Networks](https://arxiv.org/abs/1602.02830)ุ[EIE](https://arxiv.org/abs/1602.01528)ุ[Deep Compression](https://arxiv.org/abs/1510.00149) ู [Compressing Deep Convolutional Networks using Vector Quantization](https://arxiv.org/abs/1412.6115) ุงุดุงุฑู ฺฉุฑุฏ.

ุฏุฑ ูุงูุน ููุงูุงุช ุฒุงุฏ ุฏุฑ ฺูุฏ ุงุฎุฑ ุฏุฑ ุงู ุฒููู ููุชุดุฑ ุดุฏู ุงุณุช ฺฉู ุชุนุฏุงุฏ ุงุฒ ุขููุง ุฑุง ุจู ุนููุงู ูุฑุฌุน ุฏุฑ ุจุงูุง ุขูุฑุฏู.

ููฺฏุงู ฺฉู ููุงูู GoogLeNet ุฏุฑ ุณุงู 2014 ููุชุดุฑ ุดุฏ ุดุงูู ูุงฺูู ูุง Inception ูุซู ุดฺฉู ุฒุฑ ุจูุฏ:

 ![_config.yml]({{ site.baseurl }}/images/9/2.png)

ุงุฏู ุงุตู ูพุดุช ุงู ูุงฺูู ุงู ุงุณุช ฺฉู ุงุจุชุฏุง ุชูุณุท ฺฉ ฺฉุงููููุดู ุจุง ุงูุฏุงุฒู ููุชุฑ 1x1 ููุจุณุชฺฏ ูุงู ฺฉุงูุงู(cross-channel)ู ุณูพุณ ููุจุณุชฺฏ ูฺฉุงู(spatial correlations) ุชูุณุท ฺฉ ฺฉุงููููุดู ุง ุงูุฏุงุฒู ููุชุฑ 3x3 ูุญุงุณุจู ูุดูุฏ. ุงู ุฏู ุนููุงุช ุฌุฏุง ุงุฒ ฺฉุฏฺฏุฑ ุงูุฌุงู ูุดููุฏ ุ ุงุฏู ุงุตู ุงุณุชูุงุฏู ุงุฒ ฺฉุงููููุดู ุจุง ุงูุฏุงุฒู ููุชุฑ 1x1 ุจู ุงู ุฏูู ุงุณุช ฺฉู ุงู ููุชุฑ ฺฉ ูพฺฉุณู ู ุชูุงู ฺฉุงูุงู ูุง ุขู (ุจู ุนููุงู ูุซุงู ุฏุฑ ฺฉ ุนฺฉุณ ุงู ฺฉุงูุงู ูุง ุจู ุณู ฺฉุงูุงู `R ู G ู B` ุงุดุงุฑู ุฏุงุฑูุฏ) ุฑุง ุจู ฺฉ ูพฺฉุณู ุฎุฑูุฌ ูฺฏุงุดุช ูุฏูุฏ. ุงุฒ ุงู ุนููุงุช ุนูุฏุชุง ุจุฑุง ฺฉุงูุด ุชุนุฏุงุฏ ุงุจุนุงุฏ ููุชุฑ(ุนูู) ุงุณุชูุงุฏู ุงุณุชูุงุฏู ูุดูุฏ .

ฺฉุงููููุดู ุจุฑ ุญุณุจ ฺฉุงูุงู (Depthwise) ู ููุทู ุง(pointwise)

ุจุฑุง ุฏุฑฺฉ ุดุงุณุชฺฏ ู ุงุฑุฒุดููุฏ ุจูุฏู ฺฉุงููููุดู ุจุฑ ุญุณุจ ฺฉุงูุงู ู ููุทู ุง ุงุจุชุฏุง ูุงุฒ ุงุณุช ฺฉู ูพฺุฏฺฏ ูุญุงุณุจุงุช ูุงู ฺฉุงููููุดู ู ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ูุง ุฑุง ุจุฑุฑุณ ฺฉุฑุฏ.ููุงุฏ ูุง ฺฉู ุฏุฑ ุงุฏุงูู ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ ูุชูุงูุช ุงุฒ ูุชู ุฎูุฏ ููุงูุงุช ุงุณุช!

ุจุฑุง ุฏุฑฺฉ ุจูุชุฑ ุงู ุนููุงุช ูุซุงู ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ :ุฏุฑ ฺฉ ูุงู ฺฉุงููููุดูุ ูุฑุถ ฺฉูุฏ ููุงุฏุฑ ุฒุฑ ุฑุง ุฏุงุฑุฏ:

```javascript
ุงูุฏุงุฒู ููุดู ูฺฺฏ ูุฑูุฏ:W x H
ุชุนุฏุงุฏ ฺฉุงูุงู ูุง ูุฑูุฏ : N
ุงูุฏุงุฒู ููุชุฑ:K xK
ุชุนุฏุงุฏ ฺฉุงูุงู ูุง ุฎุฑูุฌ: M(ุชุนุฏุงุฏ ููุชุฑ ูุง)
```

ุจุง ุชูุฌู ุจู ููุงุฑุฏ ุฐฺฉุฑ ุดุฏู ุฏุฑ ูุซุงู ุจุงูุงุ ูพฺุฏฺฏ ูุญุงุณุจุงุช ฺฉ ูุงู ฺฉุงููููุดู ูุนููู
  `W xH xN xK^2 xM` ุฎูุงูุฏ ุจูุฏ. ุจู ุนุจุงุฑุช ูุฒูู ุนููุงุช ฺฉุงููููุดู ุจุฑุง ูุฑ ูฺฉุงู ุฏุฑ  ููุดู ูฺฺฏ ูุฑูุฏ `K^2xN`ุุงุนูุงู ฺฉุฑุฏู ุงู ุนููุงุช ุจู  ููุดู ูฺฺฏ ูุฑูุฏ ุจุง `WxH` ูฺฉุงู ุจุงุนุซ ุงุฌุงุฏ ฺฉ ููุดู ูฺฺฏ ุงุฒ ฺฉ ฺฉุงูุงู ูุดูุฏ ุงุฒ ุทุฑู ุฎุฑูุฌ ูุง ุฏุงุฑุง `M` ฺฉุงูุงู ุงุณุช .

ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ูุง: `M` ููุน ฺฉุงููููุดู ุจุง ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ `K^2xN`  ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูุชุฌู ุขู `K^2xNxM` ุฎูุงูุฏ ุดุฏ.

![_config.yml]({{ site.baseurl }}/images/9/3.png)

ฺฉุงููููุดู ููุทู ุง ุฏุฑ ูุงูุน ููุงู ฺฉุงููููุดู 1x1 ุงุณุช ฺฉู ุงููู ุจุงุฑ ุฏุฑ GoogLeNet ุงุณุชูุงุฏู ุดุฏ. *ูฺฉุชู* ุงู ุนููุงุช ุฏุฑ ูุณุฑ ุนูู ฺฉุงูุงู ูุฑูุฏ ุงูุฌุงู ูุดูุฏ . ุงุฒ ุงู ุนููุงุช ุจุฑุง ฺฉุงูุด ุงุจุนุงุฏ ููุดู ูฺฺฏ ุงุณุชูุงุฏู ูุดูุฏ. ุงุฒ ุขูุฌุง ฺฉู ฺฉุงููููุดู ููุทู ุง ุฏุฑ ูุงูุน ูุดุงุจู ฺฉ ฺฉุงููููุดู ูุนููู ุจุง ุงูุฏุงุฒู ููุชุฑ `K=1` ุงุณุช ูพฺุฏฺฏ ูุญุงุณุจุงุช `W xH xN xM` ู ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ูุง `NxM` ุฎูุงูุฏ ุจูุฏ.
![_config.yml]({{ site.baseurl }}/images/9/4.png)

ฺฉุงููููุดู ุจุฑ ุญุณุจ ฺฉุงูุงู ุนููุงุช ุฑุง ุฏุฑ ูุณุฑ ูุถุง ุจู ุทูุฑ ูุฌุฒุง ุจุฑุง ูุฑ ฺฉุฏุงู ฺฉุงูุงู ููุดู ูฺฺฏ  ุจู ุตูุฑุช ูุฌุฒุง ุงูุฌุงู ูุฏูุฏ.ูพฺุฏฺฏ ูุญุงุณุจุงุช `WxHxNxK^2` ู ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ูุง `K^2xN` ุฎูุงูุฏ ุจูุฏ.

![_config.yml]({{ site.baseurl }}/images/9/5.png)

ุจุง ุชุฑฺฉุจ ุฏู ุนููุงุช ุฐฺฉุฑ ุดุฏู ุฏุฑ ุจุงูุง ูุชูุงู ุนููุงุช ฺฉุงููููุดู ุฏุฑ ฺฉ ูุงู ุฑุง ุจุง ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ู ูุฒูู ูุญุงุณุจุงุช ุจู ูุฑุงุชุจ ฺฉูุชุฑ ุงูุฌุงู ุฏุงุฏ.ุจุง ุชูุฌู ุจู ุชูุถุญุงุช ุฐฺฉุฑ ุดุฏู ูพฺุฏฺฏ ูุญุงุณุจุงุช ุงุฒ `WxHxNxK^2xM` ุจู `WxHxNxM+WxHxNxK^2` ฺฉุงูุด ูพุฏุง ูฺฉูุฏ. ูุฑุถ ฺฉูุฏ ฺฉ ุนฺฉุณ 48 ุฏุฑ 48 ูพฺฉุณู ุจุง ุณู ฺฉุงูุงู RGB ู 64 ููุชุฑ 3x3 ุฏุงุฑู ูพฺุฏฺฏ ูุญุงุณุจุงุช ฺฉ ฺฉุงููููุดู ูุนููู 3,981,312 ู ูพฺุฏฺฏ ูุญุงุณุจุงุช ุจุง ุฑูุด ุฌุฏุฏ 504,576 ุฎูุงูุฏ ุจูุฏ ุงู ุนู ูุฒุฏฺฉ ุจู 8 ุจุฑุงุจุฑ ฺฉูุชุฑ!

ุฏู ููุงูู Xception ู MobileNets ุงุฒ ุงู ุนููุงุช ุจู ุฌุง ฺฉุงููููุดู ูุนููู ุงุณุชูุงุฏู ูฺฉููุฏ.ุจุงุฏ ูฺฏุงู ุจู ุงู ุฏู ูุนูุงุฑ ุจูุฏุงุฒู.

ูุนูุงุฑ Xception

![_config.yml]({{ site.baseurl }}/images/9/6.png)

ูุนูุงุฑ MobileNet

![_config.yml]({{ site.baseurl }}/images/9/7.png)

ุฏุฑ ุฏู ุดฺฉู ุจุงูุง ุงู ุฏู ูุนูุงุฑ ููุงุด ุฏุงุฏู ุดุฏู ุงุณุช . ุฏุฑ ุดฺฉู ุงูู ฺฉู ูุฑุจูุท ุจู ูุนูุงุฑ Xception ุงุณุช ุฏุชุง ุงุฒ ุณู ูุณูุช ุนุจูุฑ ูฺฉููุฏ ุ ฺฉู ุจุฎุด ูุงู 8 ุจุงุฑ ุชฺฉุฑุงุฑ ุดุฏู ุงุณุช . ุจุนุฏ ุงุฒ ูุฑ ูุงู depthwise ฺฉ ูุงู pointwise ู batch normalization ูุฑุงุฑ ฺฏุฑูุชู ุงุณุช ฺฉู ุฏุฑ ุดฺฉู ููุงุด ุฏุงุฏู ูุดุฏู ุงุณุช.ููุงุณู ุงู ุฏู ูุฏู ุฏุฑ ูฺฏุงู ุงูู ุบุฑ ููฺฉู ุจู ูุธุฑ ูุฑุณุฏ ุจู ููู ุนูุช ูุง ุขููุง ุฑุง ุจุฑ ุงุณุงุณ ุจูุงฺฉ ููุงุณู ูฺฉูู .

ูุงฺู MobileNets :ุงุฒ ูุณูุช ูุง ุฐุฑ ุชุดฺฉู ุดุฏู ุงุณุช :

```python
depthwise->batch normalization->ReLU->pointwise->batch normalization->ReLU
```

![_config.yml]({{ site.baseurl }}/images/9/8.png)


ูุงฺูู Xception  ุงุฒ ูุณูุช ูุง ุฐู ุชุดฺฉู ุดุฏู ุงุณุช:

```python
ReLU->depthwise->pointwise->batch normalization->ReLU->depthwise->pointwise->batch normalization->ReLU->depthwise->pointwise->batch normalization+identity mapping
```

ุงูุง ุชูุงูุช ุนูุฏู:

ูุงฺูู Xception  ุฏุงุฑุง ูููููู ุจูุงู skip connection ุงุณุช ฺฉู ุงููู ุจุงุฑ ุฏุฑ ูุนูุงุฑ ResNet ูุนุฑู ุดุฏ. 

ุฏุฑ ูุงฺูู Xception  ูฺ ุชุงุจุน ูุนุงู ุณุงุฒ ุจู ฺฉุงููููุดู depthwise  ู pointwise  ูุฌูุฏ ูุฏุงุฑุฏ.

ฺฉุฏ ููุงูู MobileNet ุฏุฑ [ุงู ููฺฉ ](https://github.com/lyk125/MobileNet-1) ูุฑุงุฑ ฺฏุฑูุชู ุงุณุชุ ููฺูู ุฏุฑ ุชูุณูุฑููู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุนููุงุช ฺฉุงููููุดู ูพุดููุงุฏ ูุชูุงูุฏ ุงุฒ ุชุงุจุน separable_conv2dุงุณุชูุงุฏู ฺฉูุฏฺฉู ุงุจุชุฏุง ุนููุงุช ฺฉุงููููุดู ุจุฑ ุญุณุจ ฺฉุงูุงู ุจู ุตูุฑุช ุฌุฏุงฺฏุงูู ุจุฑ ุฑู ูุฑ ฺฉุงูุงู ูุฑูุฏ ู ุณูพุณ ุนููุงุช ฺฉุงููููุดู ููุทู ุง ุฑุง ุจุฑ ุฑู ุงูุฌุงู ูุฏูุฏ:

```python
tf.nn.separable_conv2d(input, depthwise_filter, pointwise_filter, strides, padding, rate=None, name=None)
```

ุฏุฑ ูพุงุงู ูฺฉุงุช ุฌุงูุจ ุงุณุช ฺฉู ุฏุฑ ููุงูู ูุฏ ูุดุฏู ุงุณุช ุฑุง ุจุฑุงุชุงู ุจุงุฒฺฏู ูฺฉูู :

ุงู ูุชุฏ ุงููู ุจุงุฑ ุชูุณุท ุฏฺฉุชุฑ Laurent Sifre ุฏุฑ ุณุงู 2013 ฺฉุดู ุดุฏ ู ุฏุฑ ูุนูุงุฑ ุงูฺฉุณ ูุช ุงุนูุงู ุดุฏ ุงูุง ุฏุฑ ุงู ููุงูู ฺุฒ ุฏุฑ ุงู ุจุงุฑู ูุฏ ูุดุฏู ุงุณุช! ุจู ุนููุงู ูุฑุฌุน [ูุตู ุดุดูุุจุฎุด ุฏูู ูพุงุงู ูุงูู ุฏฺฉุชุฑุง ุงุดุงู](http://www.di.ens.fr/data/publications/papers/phd_sifre.pdf) ุฑุง ูุทุงูุนู ฺฉูุฏ. ุงู ูุชุฏ ููฺูู ุฏุฑ ฺฉููุฑุงูุณ [ICLR 2014](https://sites.google.com/site/representationlearning2014/) ุชูุณุท [Vincent Vanhoucke](https://research.google.com/pubs/VincentVanhoucke.html) ุดุฑุญ ุฏุงุฏู ุดุฏ . ุจุฑุง ุฌุฒุงุช ุจุดุชุฑ ุฏููู 20 [ุงู ูุฏู](https://youtu.be/VhLe-u0M1a8?t=1213) ุฑุง ุจุจูุฏ

![_config.yml]({{ site.baseurl }}/images/9/9.png)
